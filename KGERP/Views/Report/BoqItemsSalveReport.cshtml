@model KGERP.Data.CustomModel.ReportCustomModel
@{
    ViewData["Title"] = "Balance Sheet Report";
    Layout = "~/Views/Shared/_Layout.cshtml";

}

<style type="text/css">

    input, select, textarea {
        max-width: 100%;
    }
</style>

<section class="content-header">
    <h1>
        BoqItem Expense  Report
    </h1>
    <ol class="breadcrumb">
        <li><a href="~/Home/Index"><i class="fa fa-dashboard"></i>Dashboard</a></li>
        <li class="active"> BoqItem Expense  Report</li>
    </ol>
</section>

<section class="content">
    <div class="row">
        <div class="col-md-12">
            @using (Html.BeginForm("BoqItemsSalveReport", "Report", FormMethod.Post, new { id = "boqItemReportFormId", @class = "formValidator", @target = "_blank", @enctype = "multipart/form-data" }))
            {
                <div class="box">
                    @Html.AntiForgeryToken()
                    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                    <div class="box-danger">
                        <!-- /.box-header -->
                        <div class="box-body">
                            @Html.AntiForgeryToken()
                            @Html.HiddenFor(model => model.CompanyId)

                            <div class="row">

                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label asp-for="ProjectId" class="form-control-label">Project<sup class="text-danger" title="Required"><b>*</b></sup></label>
                                        @Html.DropDownListFor(model => model.ProjectId, new SelectList(Model.Projects.OrderBy(order => order.Name), "CostCenterId", "Name"), "==Select Project==", new { id = "ddlProjectId", @class = "form-control searchingDropdown", style = "width:100%", required = "required" })
                                        @Html.ValidationMessageFor(model => model.ProjectId, "", new { @class = "text-danger" })
                                    </div>
                                </div>



                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label asp-for="BoQItemId" class="form-control-label">BoQ Item</label>
                                        @Html.DropDownListFor(model => model.BoQItemId, new SelectList(Model.BoqItemSelectList, "Value", "Text"), "==Select BoQ Item==", new { id = "ddlBoQItemId", @class = "form-control searchingDropdown", style = "width:100%" })
                                        @Html.ValidationMessageFor(model => model.BoQItemId, "", new { @class = "text-danger" })
                                    </div>
                                </div>

                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label asp-for="BoQDivisionId" class="form-control-label">Material</label>
                                        @Html.DropDownListFor(model => model.MaterialId, new SelectList(Model.MaterialSelectList, "Text", "Value"), "==Select Division==", new { id = "ddlMaterialId", @class = "form-control searchingDropdown", style = "width:100%" })
                                        @Html.ValidationMessageFor(model => model.MaterialId, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row mt-2">
                            <div class="form-group">
                                <div class="col-md-8"></div>
                                <div class="col-md-2">
                                    <select class="pull-right" style="color:#ffffff; background-color:#dd4b39;height:34px;font-size:15px;width:100%" name="ReportType" id="ReportType">
                                        <option value="PDF">PDF</option>
                                        <option value="EXCEL">EXCEL</option>
                                        <option value="WORD">WORD</option>
                                    </select>
                                </div>
                                <div class="col-md-2">
                                    <input type="submit" name="EXPORT" style="width:100%" value="EXPORT" class="btn btn-success pull-right" formtarget="_blank" />

                                </div>


                            </div>
                        </div>

                    </div>
                    <div class="box-footer">
                    </div>

                </div>
            }
            </div>
       

        </div>

     

    </section>


    @section Scripts {
        @Scripts.Render("~/bundles/jqueryui")
        @Styles.Render("~/Content/cssjqryUi")

        <script>
            $(document).ready(function () {
                $('.datepicker').datepicker({
                    dateFormat: "mm/dd/yy",
                    showOn: 'both',
                    buttonText: "<i class='fa fa-calendar'></i>",
                    changeMonth: true,
                    changeYear: true,
                    yearRange: "2001:+50"
                });
            });


            $("#ddlProjectId").on('change', function () {

                var getProjectId = $("#ddlProjectId").val();
                var showBoqItemList = $("#ddlBoQItemId");

                $.ajax({
                    type: "GET",
                    //url: "/BillRequisition/getBoqItemList",
                    url: "/BillRequisition/getBoqItemListWithBoqNumber",
                    dataType: "json",
                    data: { id: 0, projectId: getProjectId },
                    success: function (data) {
                        showBoqItemList.empty();
                        showBoqItemList.append("<option selected disabled>==Select BoQ Item==</option>");

                        $.each(data, function (index, item) {
                            showBoqItemList.append($('<option>', {
                                value: item.BoQItemId,
                                text: item.Name
                            }));
                        });
                    }
                });
            });
            $("#ddlBoQItemId").on('change', function () {

                var getProjectId = $("#ddlProjectId").val();
                var BoqItemId = $("#ddlBoQItemId").val();
                var materialList = $("#ddlMaterialId");
                $.ajax({
                    type: "GET",
                    //url: "/BillRequisition/getBoqItemList",
                    url: "/Consumption/ConsumptionMaterialList",
                    dataType: "json",
                    data: { projectId: getProjectId, boqItemId: BoqItemId },
                    success: function (data) {
                        materialList.empty();
                        materialList.append("<option selected disabled>==Select Material ==</option>");

                        $.each(data, function (index, item) {
                            materialList.append($('<option>', {
                                value: item.MaterialId,
                                text: item.MaterialName
                            }));
                        });
                    }
                });
            });
        </script>
    }




